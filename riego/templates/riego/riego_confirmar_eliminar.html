{% extends 'autenticacion/base.html' %}

{% block title %}Eliminar Riego - AgroControl{% endblock %}
{% block page_title %}Eliminar Registro de Riego{% endblock %}

{% block page_actions %}
<a href="{% url 'riego:riego_detalle' riego.id %}" class="btn btn-outline-secondary">
    <i class="bi bi-arrow-left me-2"></i>Volver
</a>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card border-danger">
            <div class="card-header bg-danger text-white">
                <h5 class="mb-0">
                    <i class="bi bi-exclamation-triangle me-2"></i>Confirmar Eliminación
                </h5>
            </div>
            <div class="card-body">
                <div class="alert alert-warning">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>Atención:</strong> Esta acción eliminará permanentemente este registro de riego 
                    {% if riego.fertilizantes.all %}y todos los fertilizantes asociados{% endif %}.
                    Los productos fertilizantes se devolverán al inventario.
                </div>
                
                <h6>¿Está seguro que desea eliminar este registro?</h6>
                
                <div class="mt-3 p-3 bg-light rounded">
                    <div class="row mb-2">
                        <div class="col-4 text-muted">Cuartel:</div>
                        <div class="col-8"><strong>{{ riego.cuartel.nombre }}</strong></div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-4 text-muted">Fecha:</div>
                        <div class="col-8">{{ riego.fecha|date:"d/m/Y" }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-4 text-muted">Horario:</div>
                        <div class="col-8">
                            {{ riego.horario_inicio|time:"H:i" }} - {{ riego.horario_fin|time:"H:i" }}
                            <span class="badge bg-secondary ms-2">{{ riego.get_duracion_display }}</span>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-4 text-muted">Volumen Total:</div>
                        <div class="col-8">
                            <strong class="text-info">{{ riego.volumen_total_m3|floatformat:2 }} m³</strong>
                        </div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-4 text-muted">Encargado:</div>
                        <div class="col-8">{{ riego.encargado_riego.nombre_completo|default:"-" }}</div>
                    </div>
                    
                    {% if riego.incluye_fertilizante and riego.fertilizantes.all %}
                    <hr>
                    <div class="row">
                        <div class="col-12">
                            <strong class="text-success">Fertilizantes aplicados:</strong>
                            <ul class="mt-2">
                                {% for fert in riego.fertilizantes.all %}
                                <li>
                                    {{ fert.producto.nombre }} - 
                                    <strong>{{ fert.cantidad_kg }} kg</strong>
                                    <span class="text-muted">(se devolverán al inventario)</span>
                                </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <form method="post" class="mt-4">
                    {% csrf_token %}
                    <div class="d-flex justify-content-between">
                        <a href="{% url 'riego:riego_detalle' riego.id %}" class="btn btn-secondary">
                            <i class="bi bi-x-circle me-2"></i>Cancelar
                        </a>
                        <button type="submit" class="btn btn-danger">
                            <i class="bi bi-trash me-2"></i>Sí, Eliminar Registro
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Información adicional -->
        <div class="card mt-3">
            <div class="card-body">
                <h6><i class="bi bi-info-circle me-2"></i>Efectos de la eliminación:</h6>
                <ul class="mb-0">
                    <li>El registro de riego se eliminará permanentemente</li>
                    {% if riego.fertilizantes.all %}
                    <li>Los fertilizantes asociados se eliminarán del registro</li>
                    <li>Las cantidades de fertilizantes se devolverán al stock</li>
                    {% endif %}
                    <li>Esta acción no se puede deshacer</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}